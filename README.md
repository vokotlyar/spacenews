# НОВОСТИ КОСМОСА

Сайт-агрегатор новостей по космической тематике.
Предназначен для хранения и отображения новостных статей из разных сайтов-источников.
Позволяет сканировать источники на отсутствующие статьи с автоматическим добавлением на наш сайт. Можно добавлять собственные и редактировать/удалять имеющиеся новости.
На базе проекта можно легко реализовать агрегатор статей любой другой тематики.

<br>

При создании использовались:
------------------------------------
<b>
<br>• PhpStorm, Xdebug, OpenServer (Apache, MySql)
<br>• PHP, OOP, MVC, Reflection-API, PDO, Sunra-HtmlDomParser, PhpUnit, Composer, Namespaces, Sessions, Cookies, etc.
<br>• HTML/CSS
<br>• Git/GitHub
</b>

<br>

Пользовательская часть:
------------------------------------
<br>

![CC0](/description_images/main_view_01.jpg)

<b>Низ страницы:</b>
![CC0](/description_images/main_view_02.jpg)
Количество статей на странице сохраняется в куках и останется при следующем посещении.

<b>Фильтрация по источнику:</b> 
![CC0](/description_images/main_view_03.jpg)

<br>
Новостная статья состоит из небольшой картинки (для уменьшения трафика), эмблемы (со ссылкой) сайта-источника, заголовка, даты публикации и текста.
Для перехода на полную оригинальную (со всеми изображениями, видео и т.п.) статью достаточно кликнуть по заголовку.
<br>

Административная панель:
------------------------------------

<b>Авторизация:</b>
![CC0](/description_images/auth.jpg)

<b>После успешного входа:</b>
![CC0](/description_images/admin_articles.jpg)

Вид аналогичный пользовательской части, но отображаются все статьи из базы данных и заменены на красный цвета меню, футера и разделителя статей.
Внизу статьи добавлена форма выбора "Отображать/Скрыть" статью. Заголовок отображаемых (для пользовательской части) статей - зеленый, а для скрытых - красный.



При нажатии на заголовок статьи открывается <b>форма редактирования.</b> Здесь можно редактировать текст, выбрать другое изображение, Отобразить/Скрыть статью и удалить статью из БД.
![CC0](/description_images/edit_article.jpg)

После удаления статьи происходит возврат на страницу с которой переходили для редактирования. А при сохранении еще и фокусируемся на отредактированной статье.



<b>Добавление</b> своей (источником будет наш сайт) статьи:
![CC0](/description_images/add_article.jpg)

Статья добавляется неотображаемой. Можно предварительно проверить ее вид в админке:
![CC0](/description_images/added_article.jpg)



<b>Раздел сканирования источников</b> на последние (не опубликованные у нас) новостные статьи:
![CC0](/description_images/scan.jpg)

<b>После сканирования:</b>
![CC0](/description_images/scanned.jpg)

Получаем список скрытых новых статей, с которыми можно ознакомиться и сделать отображаемыми:
![CC0](/description_images/new_articles.jpg)



<b>Управление пользователями:</b>
![CC0](/description_images/users.jpg)
Отображается список всех пользователей с кнопками удаления.

При <b>добавлении/удалении</b> выводится результат операции:
![CC0](/description_images/users_add.jpg)

<br>


Внутреннее устройство:
------------------------------------



Проект реализован в <b>ООП</b> стиле. Основа - <b>паттерн MVC + БД MySQL.</b>
Точка входа - <b>index.hmtl,</b> где передается управление главному контроллеру - FrontController. В нем осуществляется разбор запроса и вызывается (с помощью Reflection API) у нужного класса запрашиваемый action-метод.



<b>Контроллеры:</b>

![CC0](/description_images/controllers.jpg)

<br>• <b>FrontController</b> - Singleton - главный контроллер.
<br>• <b>NewsController</b> - Обработка запросов к пользовательской части сайта.
<br>• <b>AdminController</b> - Обработка обращений к административной панели сайта (запросы на отображение, добавление, редактирование и сканирование статей, авторизация, управление пользователями, и т.д).



<b>Модели:</b>
<br>• <b>SpaceNewsDB</b> - Класс для работы с базой данных SpaceNews. Реализован с помощью <b>PDO</b>, что позволит (в случае необходимости) заменить MySQL на другой сервер баз данных с минимальными изменениями кода.
База данных SPACENEWS состоит из трех таблиц: source - сайт-источник новостей, news - новостные статьи, users - пользователи:
![CC0](/description_images/database.jpg)

<br>• Каждой таблице БД соответствует класс - <b>NewsSource</b> (источник новостей), <b>NewsItem</b> (новостная статья), <b>User</b> (пользователь).
<br>• <b>ImageHandler</b> - Класс для обработки новостных изображений. Главное изображение каждой новостной статьи конвертируется к необходимому виду (размеры и тип) и сохраняется в отдельную папку.
<br>• Сканирование новостных источников реализовано с помощью <b>Sunra-HtmlDomParser.</b> Для каждого сайта-источника создается класс-наследник <b>абстрактного класса NewsGetter</b>. В родитель вынесен весь общий код, а наследники реализуют абстрактные методы под каждый сайт-источник.  

![CC0](/description_images/parsers.jpg)

<br>• Модели генерирующие страницы (View) для отображения в браузере:

![CC0](/description_images/renderers.jpg)

Для каждого action в контроллерах создается соответствующий renderer. Инициализируются его поля, и производится генерация html-страницы.

<br>


<b>Тесты:</b><br>
С помощью <b>PhpUnit</b> реализованы тесты метода fillPages() класса PagingRenderer. Проверена корректность заполнения массива номеров страниц для панели перехода по новостям сайта. Тестирующий класс находится в \tests\models\renderers\PagingRendererTest.php

